# üöÄ Guide de D√©marrage - Semaine 5 AgroBizChat v2.0

## üß† Vue d'ensemble

**Objectif :** Impl√©menter une IA conversationnelle avanc√©e avec d√©tection d'intention, FAQ automatique et r√©ponses contextuelles en fran√ßais local.

---

## ‚úÖ Services Cr√©√©s Semaine 5

### üõ†Ô∏è Services Fonctionnels
1. **ConversationalAI am√©lior√©** - D√©tection d'intention et FAQ automatique
2. **Int√©gration chatbot** - Traitement intelligent des messages
3. **Sc√©narios agricoles** - Guides √©tape par √©tape
4. **Actions contextuelles** - R√©ponses adapt√©es selon l'intention

### üìä Fonctionnalit√©s
- ‚úÖ D√©tection d'intention avec patterns regex
- ‚úÖ FAQ automatique avec r√©ponses contextuelles
- ‚úÖ Sc√©narios agricoles (plantation, r√©colte, pesticides)
- ‚úÖ Gestion du contexte utilisateur
- ‚úÖ Actions sugg√©r√©es selon l'intention

---

## üöÄ √âtapes de D√©marrage

### 1. Tests des Services Semaine 5

```bash
# Valider tous les nouveaux services
python test_week5_services.py
```

**R√©sultat attendu :**
```
üöÄ D√©but des tests Semaine 5 - Intelligence conversationnelle...

üß† Test ConversationalAI...
‚úÖ Donn√©es charg√©es OK
‚úÖ Intents: 6
‚úÖ FAQ: 4
‚úÖ Sc√©narios: 3
‚úÖ Normalisation des messages OK
‚úÖ D√©tection d'intention OK
‚úÖ FAQ 'business_plan' d√©tect√©e
‚úÖ FAQ 'weather_advice' d√©tect√©e
‚úÖ FAQ 'disease_management' d√©tect√©e
‚úÖ FAQ 'payment_info' d√©tect√©e
‚úÖ Sc√©nario 'mais_plantation' d√©tect√©
‚úÖ Sc√©nario 'mais_recolte' d√©tect√©
‚úÖ Sc√©nario 'pesticide_application' d√©tect√©
üéâ ConversationalAI: Tests de base passent!

üí¨ Test traitement des messages...
‚úÖ Message 'bonjour': greeting (100.0%)
‚úÖ Message 'je veux cr√©er un business plan': business_plan (30.0%)
‚úÖ Message 'quelle est la m√©t√©o': weather (30.0%)
‚úÖ Message 'ma plante est malade': disease_diagnosis (30.0%)
‚úÖ Message 'combien √ßa co√ªte': payment (30.0%)
‚úÖ Message 'aide moi': help (30.0%)
üéâ Traitement des messages: Tous les tests passent!

üìù Test gestion du contexte...
‚úÖ Gestion du contexte OK
‚úÖ Actions sugg√©r√©es OK
üéâ Gestion du contexte: Tous les tests passent!

üìö Test FAQ et sc√©narios...
‚úÖ FAQ business_plan: 4 questions
‚úÖ FAQ weather_advice: 4 questions
‚úÖ FAQ disease_management: 4 questions
‚úÖ FAQ payment_info: 4 questions
‚úÖ Sc√©nario mais_plantation: 4 √©tapes
‚úÖ Sc√©nario mais_recolte: 4 √©tapes
‚úÖ Sc√©nario pesticide_application: 4 √©tapes
‚úÖ R√©ponses par d√©faut OK
üéâ FAQ et sc√©narios: Tous les tests passent!

üéØ Test pr√©cision d√©tection d'intention...
‚úÖ 'Bonjour, je voudrais cr√©er un busi...' -> business_plan (30.0%)
‚úÖ 'Salut, pouvez-vous me dire la m√©t√©...' -> weather (30.0%)
‚úÖ 'J'ai des feuilles jaunes sur mes p...' -> disease_diagnosis (30.0%)
‚úÖ 'Combien co√ªte votre service premi...' -> payment (30.0%)
‚úÖ 'Je ne sais pas comment utiliser vo...' -> help (30.0%)
‚úÖ 'Merci pour votre aide, au revoir' -> goodbye (30.0%)
üìä Pr√©cision: 6/6 (100.0%)
üéâ Pr√©cision de d√©tection: Test r√©ussi!

üìä R√©sultats des tests Semaine 5:
‚úÖ Tests r√©ussis: 5/5
‚ùå Tests √©chou√©s: 0/5
üéâ Tous les tests passent! Services Semaine 5 pr√™ts pour la production.
```

### 2. Test Manuel des Services

#### Test ConversationalAI

```python
from src.services.conversational_ai import ConversationalAI

# Cr√©er le service
conversational_ai = ConversationalAI()

# Test traitement de message
message = "Bonjour, je voudrais cr√©er un business plan"
result = conversational_ai.process_message(message, user_id="test_user")

print(f"Intention d√©tect√©e: {result['intent']}")
print(f"Confiance: {result['confidence']:.1%}")
print(f"R√©ponse: {result['response']}")
print(f"Actions: {result['actions']}")
```

#### Test D√©tection d'Intention

```python
# Test diff√©rentes intentions
test_messages = [
    "bonjour",
    "business plan",
    "m√©t√©o",
    "maladie",
    "paiement",
    "aide"
]

for message in test_messages:
    intent, confidence = conversational_ai._detect_intent(message)
    print(f"'{message}' -> {intent} ({confidence:.1%})")
```

#### Test FAQ et Sc√©narios

```python
# Test FAQ
faq_result = conversational_ai._check_faq("comment cr√©er un business plan")
if faq_result:
    print(f"FAQ d√©tect√©e: {faq_result['category']}")

# Test sc√©narios
scenario_result = conversational_ai._check_scenarios("plantation ma√Øs")
if scenario_result:
    print(f"Sc√©nario d√©tect√©: {scenario_result['scenario']}")
    print(f"Nombre d'√©tapes: {len(scenario_result['steps'])}")
```

### 3. Test des Conversations

#### Test Conversation Compl√®te

```python
# Simuler une conversation
conversation_messages = [
    "bonjour",
    "je veux cr√©er un business plan",
    "ma zone est la zone des terres de barre",
    "je cultive du ma√Øs",
    "merci pour votre aide"
]

user_id = "test_conversation_user"

for message in conversation_messages:
    result = conversational_ai.process_message(message, user_id)
    print(f"\nüë§ Utilisateur: {message}")
    print(f"ü§ñ Bot: {result['response'][:100]}...")
    print(f"üéØ Intention: {result['intent']} ({result['confidence']:.1%})")
```

#### Test Contexte Utilisateur

```python
# V√©rifier le contexte
context = conversational_ai.get_user_context(user_id)
print(f"Contexte utilisateur: {context}")

# Effacer le contexte
conversational_ai.clear_user_context(user_id)
context = conversational_ai.get_user_context(user_id)
print(f"Contexte apr√®s effacement: {context}")
```

### 4. Test des Webhooks avec IA

#### Test WhatsApp avec IA

```bash
# Simuler un message WhatsApp avec IA
curl -X POST "http://localhost:5000/webhook/whatsapp" \
  -H "Content-Type: application/json" \
  -d '{
    "entry": [{
      "changes": [{
        "value": {
          "messages": [{
            "type": "text",
            "from": "1234567890",
            "text": {
              "body": "bonjour, je veux cr√©er un business plan"
            }
          }]
        }
      }]
    }]
  }'
```

#### Test Telegram avec IA

```bash
# Simuler un message Telegram avec IA
curl -X POST "http://localhost:5000/webhook/telegram" \
  -H "Content-Type: application/json" \
  -d '{
    "message": {
      "from": {"id": 123456789},
      "type": "text",
      "text": "quelle est la m√©t√©o pour ma zone ?"
    }
  }'
```

---

## üìÅ Structure Cr√©√©e Semaine 5

```
src/services/
‚îî‚îÄ‚îÄ conversational_ai.py    # ‚úÖ IA conversationnelle am√©lior√©e

src/routes/
‚îî‚îÄ‚îÄ chatbot.py              # ‚úÖ Int√©gration IA dans les webhooks

test_week5_services.py      # ‚úÖ Tests complets semaine 5
```

---

## üéØ Fonctionnalit√©s Valid√©es

### ‚úÖ D√©tection d'Intention
- [x] 6 intentions principales (greeting, business_plan, weather, disease_diagnosis, payment, help, goodbye)
- [x] Patterns regex pour chaque intention
- [x] Calcul de confiance pour chaque d√©tection
- [x] Normalisation des messages

### ‚úÖ FAQ Automatique
- [x] 4 cat√©gories FAQ (business_plan, weather_advice, disease_management, payment_info)
- [x] R√©ponses contextuelles d√©taill√©es
- [x] D√©tection automatique des questions
- [x] R√©ponses en fran√ßais local

### ‚úÖ Sc√©narios Agricoles
- [x] 3 sc√©narios (mais_plantation, mais_recolte, pesticide_application)
- [x] Guides √©tape par √©tape
- [x] D√©tection des triggers
- [x] Instructions d√©taill√©es

### ‚úÖ Gestion du Contexte
- [x] Historique des conversations
- [x] Suivi des intentions
- [x] Actions sugg√©r√©es
- [x] Contexte par utilisateur

### ‚úÖ Int√©gration Chatbot
- [x] Traitement intelligent des messages
- [x] R√©ponses contextuelles
- [x] Actions automatiques
- [x] Support WhatsApp et Telegram

---

## üö® D√©pannage

### Erreur Import ConversationalAI

```bash
# V√©rifier l'import du service
python -c "from src.services.conversational_ai import ConversationalAI; print('ConversationalAI OK')"

# Test cr√©ation instance
python -c "
from src.services.conversational_ai import ConversationalAI
ai = ConversationalAI()
print('ConversationalAI cr√©√© avec succ√®s')
"
```

### Erreur D√©tection d'Intention

```bash
# Test d√©tection d'intention
python -c "
from src.services.conversational_ai import ConversationalAI
ai = ConversationalAI()
intent, conf = ai._detect_intent('bonjour')
print(f'Intention: {intent}, Confiance: {conf}')
"
```

### Erreur FAQ/Sc√©narios

```bash
# Test FAQ
python -c "
from src.services.conversational_ai import ConversationalAI
ai = ConversationalAI()
faq = ai._check_faq('business plan')
print(f'FAQ: {faq}')
"

# Test sc√©narios
python -c "
from src.services.conversational_ai import ConversationalAI
ai = ConversationalAI()
scenario = ai._check_scenarios('plantation ma√Øs')
print(f'Sc√©nario: {scenario}')
"
```

### Erreur Int√©gration Chatbot

```bash
# V√©rifier l'int√©gration
python -c "
from src.routes.chatbot import conversational_ai
print('IA int√©gr√©e dans chatbot')
"

# Test webhook simple
curl -X POST "http://localhost:5000/webhook/telegram" \
  -H "Content-Type: application/json" \
  -d '{"message": {"from": {"id": 123}, "type": "text", "text": "test"}}'
```

---

## üìä M√©triques de Succ√®s Semaine 5

- ‚úÖ **ConversationalAI** : D√©tection d'intention et FAQ automatique
- ‚úÖ **Sc√©narios Agricoles** : 3 guides √©tape par √©tape
- ‚úÖ **Gestion Contexte** : Historique et actions sugg√©r√©es
- ‚úÖ **Int√©gration Chatbot** : Traitement intelligent des messages
- ‚úÖ **Tests** : 5/5 tests passent

---

## üéâ Validation Semaine 5

Si vous obtenez :
- ‚úÖ 5/5 tests passent
- ‚úÖ D√©tection d'intention fonctionnelle
- ‚úÖ FAQ et sc√©narios d√©tect√©s
- ‚úÖ Contexte utilisateur g√©r√©
- ‚úÖ Int√©gration chatbot op√©rationnelle

**Alors la Semaine 5 est valid√©e !** üéâ

Vous pouvez passer √† la **Semaine 6 - Support ananas**.

---

## üîÑ Prochaines √âtapes

### Semaine 6 - Support ananas
1. **Base de donn√©es ananas** avec vari√©t√©s et techniques
2. **Conseils sp√©cifiques ananas** par zone agro-√©cologique
3. **Business plans ananas** avec analyses √©conomiques
4. **Diagnostic maladies ananas** par photo

### Configuration Requise Semaine 6
```env
# Base de donn√©es ananas (optionnel pour les tests)
PINEAPPLE_DATABASE_URL=your_database_url
```

---

## üß† Fonctionnalit√©s IA Conversationnelle

### ‚úÖ D√©tection d'Intention
- **Greeting** : Salutations et accueil
- **Business Plan** : Cr√©ation de plans d'affaires
- **Weather** : Informations m√©t√©o et conseils
- **Disease Diagnosis** : Diagnostic des maladies
- **Payment** : Informations sur les packages
- **Help** : Aide et fonctionnalit√©s
- **Goodbye** : Fin de conversation

### ‚úÖ FAQ Automatique
- **Business Plan** : Guide de cr√©ation complet
- **Weather Advice** : Conseils agro-m√©t√©o
- **Disease Management** : Gestion des maladies
- **Payment Info** : Informations tarifaires

### ‚úÖ Sc√©narios Agricoles
- **Plantation Ma√Øs** : Guide √©tape par √©tape
- **R√©colte Ma√Øs** : Techniques de r√©colte
- **Application Pesticides** : Bonnes pratiques

### ‚úÖ Actions Contextuelles
- **create_business_plan** : Suggestion de cr√©ation
- **get_weather** : Demande d'informations m√©t√©o
- **request_photo** : Demande de photo pour diagnostic
- **show_packages** : Affichage des packages
- **show_features** : Pr√©sentation des fonctionnalit√©s

---

## üí¨ Exemples de Conversations

### Conversation Business Plan
```
üë§ Utilisateur: bonjour
ü§ñ Bot: Bonjour ! Je suis AgroBizChat, votre assistant agricole. Comment puis-je vous aider aujourd'hui ? üåæ

üë§ Utilisateur: je veux cr√©er un business plan
ü§ñ Bot: Je peux vous aider √† cr√©er un business plan agricole complet ! üìä

Pour commencer, j'ai besoin de quelques informations :
‚Ä¢ Votre zone agro-√©cologique
‚Ä¢ La culture principale
‚Ä¢ La superficie de votre exploitation
‚Ä¢ Votre objectif (commercial, familial, etc.)

Dites-moi ces d√©tails et je g√©n√©rerai un plan personnalis√© !

üë§ Utilisateur: ma zone est la zone des terres de barre
ü§ñ Bot: Excellent ! Zone des terres de barre. Quelle est votre culture principale ?
```

### Conversation Diagnostic
```
üë§ Utilisateur: ma plante est malade
ü§ñ Bot: Je peux vous aider √† diagnostiquer les maladies de vos plantes ! üîç

Pour un diagnostic pr√©cis :
‚Ä¢ Prenez une photo claire de la plante malade
‚Ä¢ Incluez les feuilles, tiges et racines si possible
‚Ä¢ D√©crivez les sympt√¥mes observ√©s

Envoyez-moi la photo et je vous donnerai un diagnostic d√©taill√© avec les traitements recommand√©s !
```

### Conversation M√©t√©o
```
üë§ Utilisateur: quelle est la m√©t√©o
ü§ñ Bot: Je peux vous fournir des informations m√©t√©o pr√©cises pour votre zone ! üå¶Ô∏è

Pour des conseils agro-m√©t√©o personnalis√©s, dites-moi :
‚Ä¢ Votre zone agro-√©cologique
‚Ä¢ Votre culture principale
‚Ä¢ La p√©riode qui vous int√©resse

Je vous donnerai alors des conseils adapt√©s √† vos besoins !
```

---

## üéØ Avantages de l'IA Conversationnelle

### ‚úÖ Compr√©hension Naturelle
- D√©tection automatique des intentions
- R√©ponses contextuelles
- Gestion des variations linguistiques

### ‚úÖ Exp√©rience Utilisateur
- Conversations fluides
- R√©ponses imm√©diates
- Actions sugg√©r√©es automatiquement

### ‚úÖ Personnalisation
- Contexte utilisateur maintenu
- Historique des conversations
- R√©ponses adapt√©es au profil

### ‚úÖ Scalabilit√©
- Base de connaissances extensible
- Nouveaux sc√©narios facilement ajoutables
- FAQ mise √† jour automatiquement 